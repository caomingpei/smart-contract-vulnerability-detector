# Array Length Assignment

## 基本情况
* 检查器：controlled-array-length
* 严重程度：高
* 检查置信度：中

## 描述
检查每个数组长度的分配

## 利用案例
```solidity
contract A {
	uint[] testArray; // dynamic size array

	function f(uint usersCount) public {
		// ...
		testArray.length = usersCount;
		// ...
	}

	function g(uint userIndex, uint val) public {
		// ...
		testArray[userIndex] = val;
		// ...
	}
}
```

合约的存储/状态变量都是用一个256比特的整数为索引的，用户可以将数组的长度设置为2^256-1去给所有的存储空间编号。在上面的例子中，一个用户可以调用f函数去设置数组的长度，然后调用g函数去控制存储空间。值得注意的是，此处的存储槽是通过索引器的散列进行索引的；尽管如此，所有存储仍然可以访问并且可以由攻击者控制。

## 推荐方式

不允许直接设置数组长度；相反，选择根据需要增加数值。否则，彻底审查合同，以确保用户控制的变量不能达到数组长度的分配。

